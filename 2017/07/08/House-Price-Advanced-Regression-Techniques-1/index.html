<!doctype html>



  


<html class="theme-next mist use-motion" lang="en">
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="machine learning,python,data analysis," />





  <link rel="alternate" href="/atom.xml" title="Isaac Changhau" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/tltimg.jpg?v=5.1.1" />






<meta name="description" content="House Prices: Advanced Regression Techniques is a kaggle competition to predict the house prices, which aims to practice feature engineering, RFs, and gradient boosting.">
<meta name="keywords" content="machine learning,python,data analysis">
<meta property="og:type" content="article">
<meta property="og:title" content="House Prices Advanced Regression Techniques -- Data Analysis Exploration">
<meta property="og:url" content="https://isaacchanghau.github.io/2017/07/08/House-Price-Advanced-Regression-Techniques-1/index.html">
<meta property="og:site_name" content="Isaac Changhau">
<meta property="og:description" content="House Prices: Advanced Regression Techniques is a kaggle competition to predict the house prices, which aims to practice feature engineering, RFs, and gradient boosting.">
<meta property="og:locale" content="en">
<meta property="og:image" content="https://isaacchanghau.github.io/images/machinelearning/houseprices/salepricedist.png">
<meta property="og:image" content="https://isaacchanghau.github.io/images/machinelearning/houseprices/salepricedistlog.png">
<meta property="og:image" content="https://isaacchanghau.github.io/images/machinelearning/houseprices/correlation1.png">
<meta property="og:image" content="https://isaacchanghau.github.io/images/machinelearning/houseprices/correlation2.png">
<meta property="og:image" content="https://isaacchanghau.github.io/images/machinelearning/houseprices/scatters.png">
<meta property="og:image" content="https://isaacchanghau.github.io/images/machinelearning/houseprices/bsmt.png">
<meta property="og:image" content="https://isaacchanghau.github.io/images/machinelearning/houseprices/totalsf.png">
<meta property="og:image" content="https://isaacchanghau.github.io/images/machinelearning/houseprices/overallqual.png">
<meta property="og:image" content="https://isaacchanghau.github.io/images/machinelearning/houseprices/yearbuilt.png">
<meta property="og:image" content="https://isaacchanghau.github.io/images/machinelearning/houseprices/totalsf.png">
<meta property="og:image" content="https://isaacchanghau.github.io/images/machinelearning/houseprices/totalsf-dist.png">
<meta property="og:image" content="https://isaacchanghau.github.io/images/machinelearning/houseprices/totalsf-dist-log.png">
<meta property="og:image" content="https://isaacchanghau.github.io/images/machinelearning/houseprices/homoscedasticity-totalsf.png">
<meta property="og:image" content="https://isaacchanghau.github.io/images/machinelearning/houseprices/grlivarea.png">
<meta property="og:image" content="https://isaacchanghau.github.io/images/machinelearning/houseprices/grlivarea-dist.png">
<meta property="og:image" content="https://isaacchanghau.github.io/images/machinelearning/houseprices/grlivarea-dist-log.png">
<meta property="og:image" content="https://isaacchanghau.github.io/images/machinelearning/houseprices/homoscedasticity-grlivarea.png">
<meta property="og:image" content="https://isaacchanghau.github.io/images/machinelearning/houseprices/1.png">
<meta property="og:image" content="https://isaacchanghau.github.io/images/machinelearning/houseprices/2.png">
<meta property="og:image" content="https://isaacchanghau.github.io/images/machinelearning/houseprices/yearremodadd.png">
<meta property="og:updated_time" content="2017-09-21T08:51:07.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="House Prices Advanced Regression Techniques -- Data Analysis Exploration">
<meta name="twitter:description" content="House Prices: Advanced Regression Techniques is a kaggle competition to predict the house prices, which aims to practice feature engineering, RFs, and gradient boosting.">
<meta name="twitter:image" content="https://isaacchanghau.github.io/images/machinelearning/houseprices/salepricedist.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    sidebar: {"position":"right","display":"post","offset":12,"offset_float":0,"b2t":true,"scrollpercent":true},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://isaacchanghau.github.io/2017/07/08/House-Price-Advanced-Regression-Techniques-1/"/>





  <title>House Prices Advanced Regression Techniques -- Data Analysis Exploration | Isaac Changhau</title><!-- hexo-inject:begin --><!-- hexo-inject:end -->
  














</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="container sidebar-position-right page-post-detail ">
    <div class="headband"></div>
    
    <!--<a href="https://github.com/IsaacChanghau"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://camo.githubusercontent.com/38ef81f8aca64bb9a64448d0d70f1308ef5341ab/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f6461726b626c75655f3132313632312e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png"></a>-->

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Isaac Changhau</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">Stay Hungry, Stay Foolish</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th-list"></i> <br />
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-vcard"></i> <br />
            
            About
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            Search
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="Searching..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://isaacchanghau.github.io/2017/07/08/House-Price-Advanced-Regression-Techniques-1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Isaac Changhau">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Isaac Changhau">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">House Prices Advanced Regression Techniques -- Data Analysis Exploration</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-07-08T22:08:02+08:00">
                2017-07-08
              </time>
            

            
              <span class="post-updated">
                &nbsp; | &nbsp; <i class="fa fa-calendar-check-o"></i> Updated on
                <time itemprop="dateUpdated" datetime="2017-09-21T16:51:07+08:00" content="2017-09-21">
                  2017-09-21
                </time>
              </span>
            

            

            
          </span>

          
            <span class="post-letters-count">
              &nbsp; | &nbsp;
              <i class="fa fa-file-word-o"></i>
            <span>Count 4,049 words</span>
              <!--&nbsp; | &nbsp;
              <i class="fa fa-clock-o"></i>
            <span>Reading 25 min</span>-->
            </span>
          

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Machine-Learning/" itemprop="url" rel="index">
                    <span itemprop="name">Machine Learning</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        <p><a href="https://www.kaggle.com/c/house-prices-advanced-regression-techniques" target="_blank" rel="noopener">House Prices: Advanced Regression Techniques</a> is a <a href="https://www.kaggle.com/" target="_blank" rel="noopener">kaggle</a> competition to predict the house prices, which aims to practice feature engineering, RFs, and gradient boosting.<a id="more"></a> After exploring and referring others’ methods, I decide to do it by myself to improve my python skill in data science and data analysis ability.</p>
<h1 id="competition-description">Competition Description</h1>
<p>Ask a home buyer to describe their dream house, and they probably won’t begin with the height of the basement ceiling or the proximity to an east-west railroad. But this playground competition’s dataset proves that much more influences price negotiations than the number of bedrooms or a white-picket fence. With 79 explanatory variables describing (almost) every aspect of residential homes in Ames, Iowa, this competition challenges you to predict the final price of each home.</p>
<p>The data contains three parts, one is <code>data_description.txt</code>, which gives brief summary of the data information, another two, <code>train.csv</code> and <code>test.csv</code>, are the datasets used to train and test. More details of the data fields’ description are available here: <a href="https://www.kaggle.com/c/house-prices-advanced-regression-techniques/data" target="_blank" rel="noopener">[link]</a>.</p>
<h1 id="data-analysis-and-feature-extraction">Data Analysis and Feature Extraction</h1>
<h2 id="preliminary-analysis">Preliminary Analysis</h2>
<h3 id="data-preview">Data Preview</h3>
<p>First of all, we need to load the data and have a glance of it. <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">train = pd.read_csv(<span class="string">'train.csv'</span>)</span><br><span class="line">test = pd.read_csv(<span class="string">'test.csv'</span>)</span><br><span class="line">train_labels = train.pop(<span class="string">'SalePrice'</span>) <span class="comment"># separate labels from train dataset</span></span><br><span class="line">data = pd.concat([train, test], keys=[<span class="string">'train'</span>, <span class="string">'test'</span>])</span><br><span class="line">print(data.columns) <span class="comment"># check column decorations</span></span><br><span class="line">print(<span class="string">'rows:'</span>, data.shape[<span class="number">0</span>], <span class="string">', columns:'</span>, data.shape[<span class="number">1</span>]) <span class="comment"># count rows of total dataset</span></span><br><span class="line">print(<span class="string">'rows in train dataset:'</span>, train.shape[<span class="number">0</span>])</span><br><span class="line">print(<span class="string">'rows in test dataset:'</span>, test.shape[<span class="number">0</span>])</span><br></pre></td></tr></table></figure></p>
<p>the output is shown below: <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">Index([<span class="string">'Id'</span>, <span class="string">'MSSubClass'</span>, <span class="string">'MSZoning'</span>, <span class="string">'LotFrontage'</span>, <span class="string">'LotArea'</span>, <span class="string">'Street'</span>,</span><br><span class="line">       <span class="string">'Alley'</span>, <span class="string">'LotShape'</span>, <span class="string">'LandContour'</span>, <span class="string">'Utilities'</span>, <span class="string">'LotConfig'</span>,</span><br><span class="line">       <span class="string">'LandSlope'</span>, <span class="string">'Neighborhood'</span>, <span class="string">'Condition1'</span>, <span class="string">'Condition2'</span>, <span class="string">'BldgType'</span>,</span><br><span class="line">       <span class="string">'HouseStyle'</span>, <span class="string">'OverallQual'</span>, <span class="string">'OverallCond'</span>, <span class="string">'YearBuilt'</span>, <span class="string">'YearRemodAdd'</span>,</span><br><span class="line">       <span class="string">'RoofStyle'</span>, <span class="string">'RoofMatl'</span>, <span class="string">'Exterior1st'</span>, <span class="string">'Exterior2nd'</span>, <span class="string">'MasVnrType'</span>,</span><br><span class="line">       <span class="string">'MasVnrArea'</span>, <span class="string">'ExterQual'</span>, <span class="string">'ExterCond'</span>, <span class="string">'Foundation'</span>, <span class="string">'BsmtQual'</span>,</span><br><span class="line">       <span class="string">'BsmtCond'</span>, <span class="string">'BsmtExposure'</span>, <span class="string">'BsmtFinType1'</span>, <span class="string">'BsmtFinSF1'</span>,</span><br><span class="line">       <span class="string">'BsmtFinType2'</span>, <span class="string">'BsmtFinSF2'</span>, <span class="string">'BsmtUnfSF'</span>, <span class="string">'TotalBsmtSF'</span>, <span class="string">'Heating'</span>,</span><br><span class="line">       <span class="string">'HeatingQC'</span>, <span class="string">'CentralAir'</span>, <span class="string">'Electrical'</span>, <span class="string">'1stFlrSF'</span>, <span class="string">'2ndFlrSF'</span>,</span><br><span class="line">       <span class="string">'LowQualFinSF'</span>, <span class="string">'GrLivArea'</span>, <span class="string">'BsmtFullBath'</span>, <span class="string">'BsmtHalfBath'</span>, <span class="string">'FullBath'</span>,</span><br><span class="line">       <span class="string">'HalfBath'</span>, <span class="string">'BedroomAbvGr'</span>, <span class="string">'KitchenAbvGr'</span>, <span class="string">'KitchenQual'</span>,</span><br><span class="line">       <span class="string">'TotRmsAbvGrd'</span>, <span class="string">'Functional'</span>, <span class="string">'Fireplaces'</span>, <span class="string">'FireplaceQu'</span>, <span class="string">'GarageType'</span>,</span><br><span class="line">       <span class="string">'GarageYrBlt'</span>, <span class="string">'GarageFinish'</span>, <span class="string">'GarageCars'</span>, <span class="string">'GarageArea'</span>, <span class="string">'GarageQual'</span>,</span><br><span class="line">       <span class="string">'GarageCond'</span>, <span class="string">'PavedDrive'</span>, <span class="string">'WoodDeckSF'</span>, <span class="string">'OpenPorchSF'</span>,</span><br><span class="line">       <span class="string">'EnclosedPorch'</span>, <span class="string">'3SsnPorch'</span>, <span class="string">'ScreenPorch'</span>, <span class="string">'PoolArea'</span>, <span class="string">'PoolQC'</span>,</span><br><span class="line">       <span class="string">'Fence'</span>, <span class="string">'MiscFeature'</span>, <span class="string">'MiscVal'</span>, <span class="string">'MoSold'</span>, <span class="string">'YrSold'</span>, <span class="string">'SaleType'</span>,</span><br><span class="line">       <span class="string">'SaleCondition'</span>],</span><br><span class="line">      dtype=<span class="string">'object'</span>)</span><br><span class="line">rows: 2919, columns: 80</span><br><span class="line">rows <span class="keyword">in</span> train dataset: 1460</span><br><span class="line">rows <span class="keyword">in</span> <span class="built_in">test</span> dataset: 1459</span><br></pre></td></tr></table></figure></p>
<p>Here we have 2919 lines records in total, 1460 lines for training and 1459 lines for testing. Each line has 79 properties (<code>Id</code> is eliminated). Then we take a look at the situation of data missing: <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">nans = pd.concat([train.isnull().sum(), train.isnull().sum() / train.shape[<span class="number">0</span>], test.isnull().sum(), test.isnull().sum() / test.shape[<span class="number">0</span>]], axis=<span class="number">1</span>, keys=[<span class="string">'Train'</span>, <span class="string">'Percentage'</span>, <span class="string">'Test'</span>, <span class="string">'Percentage'</span>])</span><br><span class="line">print(nans[nans.sum(axis=<span class="number">1</span>) &gt; <span class="number">0</span>])</span><br></pre></td></tr></table></figure></p>
<p>we find that <code>Alley</code>, <code>FireplaceQu</code>, <code>PoolQC</code>, <code>Fence</code> and <code>MiscFeature</code> suffer almost or more than 50% data missing. Normally, if the property has more 15% information loss, we should delete it. <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">              Train  Percentage  Test  Percentage</span><br><span class="line">MSZoning          0    0.000000     4    0.002742</span><br><span class="line">LotFrontage     259    0.177397   227    0.155586</span><br><span class="line">Alley          1369    0.937671  1352    0.926662</span><br><span class="line">Utilities         0    0.000000     2    0.001371</span><br><span class="line">Exterior1st       0    0.000000     1    0.000685</span><br><span class="line">Exterior2nd       0    0.000000     1    0.000685</span><br><span class="line">MasVnrType        8    0.005479    16    0.010966</span><br><span class="line">MasVnrArea        8    0.005479    15    0.010281</span><br><span class="line">BsmtQual         37    0.025342    44    0.030158</span><br><span class="line">BsmtCond         37    0.025342    45    0.030843</span><br><span class="line">BsmtExposure     38    0.026027    44    0.030158</span><br><span class="line">BsmtFinType1     37    0.025342    42    0.028787</span><br><span class="line">BsmtFinSF1        0    0.000000     1    0.000685</span><br><span class="line">BsmtFinType2     38    0.026027    42    0.028787</span><br><span class="line">BsmtFinSF2        0    0.000000     1    0.000685</span><br><span class="line">BsmtUnfSF         0    0.000000     1    0.000685</span><br><span class="line">TotalBsmtSF       0    0.000000     1    0.000685</span><br><span class="line">Electrical        1    0.000685     0    0.000000</span><br><span class="line">BsmtFullBath      0    0.000000     2    0.001371</span><br><span class="line">BsmtHalfBath      0    0.000000     2    0.001371</span><br><span class="line">KitchenQual       0    0.000000     1    0.000685</span><br><span class="line">Functional        0    0.000000     2    0.001371</span><br><span class="line">FireplaceQu     690    0.472603   730    0.500343</span><br><span class="line">GarageType       81    0.055479    76    0.052090</span><br><span class="line">GarageYrBlt      81    0.055479    78    0.053461</span><br><span class="line">GarageFinish     81    0.055479    78    0.053461</span><br><span class="line">GarageCars        0    0.000000     1    0.000685</span><br><span class="line">GarageArea        0    0.000000     1    0.000685</span><br><span class="line">GarageQual       81    0.055479    78    0.053461</span><br><span class="line">GarageCond       81    0.055479    78    0.053461</span><br><span class="line">PoolQC         1453    0.995205  1456    0.997944</span><br><span class="line">Fence          1179    0.807534  1169    0.801234</span><br><span class="line">MiscFeature    1406    0.963014  1408    0.965045</span><br><span class="line">SaleType          0    0.000000     1    0.000685</span><br></pre></td></tr></table></figure></p>
<h3 id="labels-saleprice">Labels (“SalePrice”)</h3>
<p>After that, let’s extract some information from the <code>SalePrice</code>, which is also the most important thing, since our task is to predict it. From the information shown below, we can derive the data summary of <code>SalePrice</code>, which provides <code>mean</code>, <code>standard deviation</code>, <code>minimum</code>, <code>maximum</code> and so forth. <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">print(train_labels.describe())</span><br><span class="line"></span><br><span class="line">count      <span class="number">1460.000000</span></span><br><span class="line">mean     <span class="number">180921.195890</span></span><br><span class="line">std       <span class="number">79442.502883</span></span><br><span class="line">min       <span class="number">34900.000000</span></span><br><span class="line"><span class="number">25</span>%      <span class="number">129975.000000</span></span><br><span class="line"><span class="number">50</span>%      <span class="number">163000.000000</span></span><br><span class="line"><span class="number">75</span>%      <span class="number">214000.000000</span></span><br><span class="line">max      <span class="number">755000.000000</span></span><br><span class="line">Name: SalePrice, dtype: float64</span><br></pre></td></tr></table></figure></p>
<p>Then we plot its distribution histogram and normal probalility graph. <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> scipy <span class="keyword">import</span> stats</span><br><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line">sns.plt.figure()</span><br><span class="line">sns.plt.subplot(<span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>)</span><br><span class="line">sns.plt.title(<span class="string">"Sale Prices Dist"</span>)</span><br><span class="line">sns.distplot(train_labels, fit=stats.norm)</span><br><span class="line">sns.plt.subplot(<span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>)</span><br><span class="line">stats.probplot(train_labels, plot=sns.plt)</span><br><span class="line">sns.plt.show()</span><br><span class="line">print(<span class="string">"Skewness: %f"</span> % train_labels.skew())</span><br><span class="line">print(<span class="string">"Kurtosis: %f"</span> % train_labels.kurt())</span><br><span class="line"><span class="comment"># Skewness and Kurtosis</span></span><br><span class="line">Skewness: <span class="number">1.882876</span></span><br><span class="line">Kurtosis: <span class="number">6.536282</span></span><br></pre></td></tr></table></figure></p>
<p>The graph shows that the distribution of <code>SalePrice</code> deviates from the normal distribution, it has peak value and it is positive biased, but it does not follow the diagonal line (right side), the diagonal line represents the normal distribution in normal probability graph, and a good data distribution should follow this line closely. <img src="/images/machinelearning/houseprices/salepricedist.png" alt="Sale Prices Distribution"> In order to solve such problems, we can explore to use the <strong>logarithmic transformation</strong> to see if it is able to handle these problems. <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">sns.plt.figure()</span><br><span class="line">sns.plt.subplot(<span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>)</span><br><span class="line">sns.plt.title(<span class="string">"Sale Prices Dist"</span>)</span><br><span class="line">sns.distplot(np.log(train_labels), fit=stats.norm)</span><br><span class="line">sns.plt.subplot(<span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>)</span><br><span class="line">stats.probplot(np.log(train_labels), plot=sns.plt)</span><br><span class="line">sns.plt.show()</span><br><span class="line">print(<span class="string">"Skewness: %f"</span> % np.log(train_labels).skew())</span><br><span class="line">print(<span class="string">"Kurtosis: %f"</span> % np.log(train_labels).kurt())</span><br><span class="line"><span class="comment"># Skewness and Kurtosis</span></span><br><span class="line">Skewness: <span class="number">0.121335</span></span><br><span class="line">Kurtosis: <span class="number">0.809532</span></span><br></pre></td></tr></table></figure></p>
<p>See the graph below, it is obvious that the data distribution follows diagonal line better than the previous one, although some outliers exist. thus, it seems that the log transformation is a good choice to transform the data. <img src="/images/machinelearning/houseprices/salepricedistlog.png" alt="Sale Prices Distribution after Log"></p>
<h2 id="systematic-analysis">Systematic Analysis</h2>
<h3 id="data-clean-integration-and-correlation-analysis">Data Clean, Integration and Correlation Analysis</h3>
<p>After having some preliminary understanding of the data, next step, we need to explore the relationship between those properties and labels, as well as the internal relationship among those properties and so forth. In the preliminary analysis, we did the analysis on the overall dataset (training dataset + testing dataset). However, in this part, we should only consider the training part (To make the analysis more fair). There are (generally) two types of properties, one is numeric and another is categorical. First of all, we need to drop some unused properties according to the data missing information. As mentioned before, <code>Alley</code>, <code>FireplaceQu</code>, <code>PoolQC</code>, <code>Fence</code> and <code>MiscFeature</code> suffer almost or more than 50% data loss: - <strong>Alley</strong>: Type of alley access - <strong>FireplaceQu</strong>: Fireplace quality - <strong>PoolQC</strong>: Pool quality - <strong>Fence</strong>: Fence quality - <strong>MiscFeature</strong>: Miscellaneous feature not covered in other categories</p>
<p>Under normal conditions, those features are not within the scope of our consideration when we buy a house, so these features are not important and should be eliminated from the dataset. <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">train.drop([<span class="string">'Id'</span>, <span class="string">'MiscFeature'</span>, <span class="string">'Fence'</span>, <span class="string">'PoolQC'</span>, <span class="string">'FireplaceQu'</span>, <span class="string">'Alley'</span>], axis=<span class="number">1</span>, inplace=<span class="keyword">True</span>)</span><br></pre></td></tr></table></figure></p>
<p>Here we draw the correlation coefficient matrix to explore the coorelation among different properties: <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># draw correlation coefficient matrix</span></span><br><span class="line">corrmat = train.corr()</span><br><span class="line">f, ax = sns.plt.subplots(figsize=(<span class="number">12</span>, <span class="number">9</span>))</span><br><span class="line">sns.heatmap(corrmat, vmax=<span class="number">.8</span>, square=<span class="keyword">True</span>)</span><br><span class="line">sns.plt.yticks(rotation=<span class="number">0</span>)</span><br><span class="line">sns.plt.xticks(rotation=<span class="number">90</span>)</span><br><span class="line">sns.plt.show()</span><br></pre></td></tr></table></figure></p>
<p>From the graph below, we can clearly see that there are two group of features show high correlation (the two big red blocks), one is the correlation coefficient between <code>TotalBsmtSF</code> and <code>1stFlrSF</code>, another is <code>Garage...</code> feature group. <img src="/images/machinelearning/houseprices/correlation1.png" alt="correlation coefficient matrix"> The two examples indicate that these features have strong correlation with each other, actually, the degree of correlation reaches the situation of multicollinearity, thus, we can treat that those features contains almost the same information. If you see the <code>SalePrice</code>, you will find that the <code>SalePrice</code> has strong correlations not only <code>GrLivArea</code>, <code>TotalBsmtSF</code> and <code>OverallQual</code>, but also some other features, here we draw the correlation coefficient matrix of <code>SalePrice</code> to show the top 10 features: <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">cols = corrmat.nlargest(<span class="number">10</span>, <span class="string">'SalePrice'</span>)[<span class="string">'SalePrice'</span>].index</span><br><span class="line">cm = np.corrcoef(train[cols].values.T)</span><br><span class="line">sns.set(font_scale=<span class="number">1.25</span>)</span><br><span class="line">hm = sns.heatmap(cm, cbar=<span class="keyword">True</span>, annot=<span class="keyword">True</span>, square=<span class="keyword">True</span>, fmt=<span class="string">'.2f'</span>, annot_kws=&#123;<span class="string">'size'</span>: <span class="number">10</span>&#125;, yticklabels=cols.values,</span><br><span class="line">                 xticklabels=cols.values)</span><br><span class="line">sns.plt.yticks(rotation=<span class="number">0</span>)</span><br><span class="line">sns.plt.xticks(rotation=<span class="number">90</span>)</span><br><span class="line">sns.plt.show()</span><br></pre></td></tr></table></figure></p>
<p>The graph below gives top 10 features which have strong correlation with each other. <img src="/images/machinelearning/houseprices/correlation2.png" alt="correlation coefficient matrix of SalePrice"> We can derive here that - <code>OverallQual</code>, <code>GrLivArea</code> and <code>TotalBsmtSF</code> have strong correlation with <code>SalePrice</code>. - <code>GarageCars</code> and <code>GarageArea</code> not only have strong correlation with <code>SalePrice</code>, but also have strong correlation with each other. It is easy to imagine that the number of cars store in garage is strong depends on the area of garage, which means that one of them is enough to represent the relationship between <code>SalePrice</code> and <code>Garage...</code>. Here, we choose <code>GarageCars</code>, since it has slightly higher score (Same for other <code>Garage...</code> features). - The relationship between <code>TotalBsmtSF</code> and <code>1stFlrSF</code> is almost same as <code>GarageCars</code> and <code>GarageArea</code>, we can also choose one of them, but here we will use another strategy, and will be discussed later. - According to the data description and the graph here, we find that <code>GrLivArea</code> and <code>TotRmsAbvGrd</code> are the similar features too. Their correlation is <strong>0.83</strong>, and the <code>GrLivArea</code> represents the “Above grade (ground) living area square feet”, while <code>TotRmsAbvGrd</code> indicates “Total rooms above grade (does not include bathrooms)”. - Another thing is that the <code>FullBath</code> and <code>YearBuilt</code> do not have siginificantly strong correlation with <code>SalePrice</code>.</p>
<p>Here we also show the scatter graph between <code>SalePrice</code> and the most important features: <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sns.set()</span><br><span class="line">cols = [<span class="string">'SalePrice'</span>, <span class="string">'OverallQual'</span>, <span class="string">'GrLivArea'</span>, <span class="string">'GarageCars'</span>, <span class="string">'TotalBsmtSF'</span>, <span class="string">'FullBath'</span>, <span class="string">'YearBuilt'</span>]</span><br><span class="line">sns.pairplot(train[cols], size=<span class="number">2.5</span>)</span><br><span class="line">sns.plt.show()</span><br></pre></td></tr></table></figure></p>
<p><img src="/images/machinelearning/houseprices/scatters.png" alt="Scatters"> This scatters graph gives much more affluent information of the relationships among those features. As mentioned just now, we will drop the feature <code>GarageArea</code>. For <code>Bsmt...</code> features group, if you have studied the data in Excel carefully, you will find that <code>TotalBsmtSF</code> equals to the sum of <code>BsmtFinSF1</code>, <code>BsmtFinSF2</code> and <code>BsmtUnfSF</code>, which means that by keeping the <code>TotalBsmtSF</code>, <code>BsmtFinSF1</code>, <code>BsmtFinSF2</code> and <code>BsmtUnfSF</code> are able to be eliminated. Since we also need to handle <code>TotalBsmtSF</code> and <code>1stFlrSF</code>, here we visually show their relationship with <code>SalePrice</code>: <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">f, (ax1, ax2, ax3) = sns.plt.subplots(<span class="number">1</span>, <span class="number">3</span>)</span><br><span class="line">data_total = pd.concat([train[<span class="string">'SalePrice'</span>], train[<span class="string">'TotalBsmtSF'</span>]], axis=<span class="number">1</span>)</span><br><span class="line">data_total.plot.scatter(x=<span class="string">'TotalBsmtSF'</span>, y=<span class="string">'SalePrice'</span>, ylim=(<span class="number">0</span>, <span class="number">800000</span>), ax=ax1)</span><br><span class="line">data1 = pd.concat([train[<span class="string">'SalePrice'</span>], train[<span class="string">'1stFlrSF'</span>]], axis=<span class="number">1</span>)</span><br><span class="line">data1.plot.scatter(x=<span class="string">'1stFlrSF'</span>, y=<span class="string">'SalePrice'</span>, ylim=(<span class="number">0</span>, <span class="number">800000</span>), ax=ax2)</span><br><span class="line">data2 = pd.concat([train[<span class="string">'SalePrice'</span>], train[<span class="string">'2ndFlrSF'</span>]], axis=<span class="number">1</span>)</span><br><span class="line">data2.plot.scatter(x=<span class="string">'2ndFlrSF'</span>, y=<span class="string">'SalePrice'</span>, ylim=(<span class="number">0</span>, <span class="number">800000</span>), ax=ax3)</span><br><span class="line">sns.plt.show()</span><br></pre></td></tr></table></figure></p>
<p>we can derive the fighre below, the first graph is <code>TotalBsmtSF</code>-<code>SalePrice</code>, the second is <code>1stFlrSF</code>-<code>SalePrice</code> and the last one is <code>2ndFlrSF</code>-<code>SalePrice</code>. Generally, all of these three features have closely relationship with <code>SalePrice</code>, and follow the exponential distribution. Only some specific situations that the <code>TotalBsmtSF</code> has no influence on <code>SalePrice</code> (those zero values), while <code>2ndFlrSF</code> does also (although there are much more zero values in <code>2ndFlrSF</code>, the trend is similar). <img src="/images/machinelearning/houseprices/bsmt.png" alt="Basement, 1st, 2nd"> The description of <code>TotalBsmtSF</code>, <code>1stFlrSF</code> and <code>2ndFlrSF</code>: - <strong>TotalBsmtSF</strong>: Total square feet of basement area. - <strong>1stFlrSF</strong>: First Floor square feet. - <strong>2ndFlrSF</strong>: Second floor square feet.</p>
<p>In this case, since all of them are the area information of the house and their relationships with <code>SalePrice</code> are similar, so our strategy is creating a new feature named as <code>TotalSF</code> to add those three features, then drop them. <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">train.drop([<span class="string">'BsmtFinSF1'</span>, <span class="string">'BsmtFinSF2'</span>, <span class="string">'BsmtUnfSF'</span>], axis=<span class="number">1</span>, inplace=<span class="keyword">True</span>)</span><br><span class="line">train[<span class="string">'TotalBsmtSF'</span>] = train[<span class="string">'TotalBsmtSF'</span>].fillna(<span class="number">0</span>)</span><br><span class="line">train[<span class="string">'1stFlrSF'</span>] = train[<span class="string">'1stFlrSF'</span>].fillna(<span class="number">0</span>)</span><br><span class="line">train[<span class="string">'2ndFlrSF'</span>] = train[<span class="string">'2ndFlrSF'</span>].fillna(<span class="number">0</span>)</span><br><span class="line">train[<span class="string">'TotalSF'</span>] = train[<span class="string">'TotalBsmtSF'</span>] + train[<span class="string">'1stFlrSF'</span>] + train[<span class="string">'2ndFlrSF'</span>]</span><br><span class="line">train.drop([<span class="string">'TotalBsmtSF'</span>, <span class="string">'1stFlrSF'</span>, <span class="string">'2ndFlrSF'</span>], axis=<span class="number">1</span>, inplace=<span class="keyword">True</span>)</span><br><span class="line">train.drop([<span class="string">'GarageArea'</span>], axis=<span class="number">1</span>, inplace=<span class="keyword">True</span>) <span class="comment"># as analysis before</span></span><br></pre></td></tr></table></figure></p>
<p>and the relationship between <code>TotalSF</code> and <code>SalePrice</code> is show below: <img src="/images/machinelearning/houseprices/totalsf.png" alt="TotalSF"> Intuitively, the merged feature has a better exponential relationship with <code>SalePrice</code>, compare to the previous three fatures. The two outliers appear in the graph can be considered as the abnormal values and delete them. In the discuss above, we only anslysis and clear some of the most important numeric features, other numeric also needs to be analyzed as well as the categorical features. Becasue of the space limit, here we do not talk much on this process, and below gives some features that I choose to get rid of, since I think they do not have much correlation to <code>SalePrice</code> or some of these features have strong correlation with the features we already decide to retain (which means they are similar, so keep one of them is enough). <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">train.drop([<span class="string">'Utilities'</span>, <span class="string">'RoofMatl'</span>, <span class="string">'MasVnrArea'</span>, <span class="string">'MasVnrType'</span>, <span class="string">'Heating'</span>, <span class="string">'LowQualFinSF'</span>,</span><br><span class="line">            <span class="string">'BsmtFullBath'</span>, <span class="string">'BsmtHalfBath'</span>, <span class="string">'BsmtQual'</span>, <span class="string">'BsmtCond'</span>, <span class="string">'BsmtExposure'</span>, <span class="string">'BsmtFinType1'</span>, <span class="string">'BsmtFinType2'</span>,</span><br><span class="line">            <span class="string">'Functional'</span>, <span class="string">'GarageYrBlt'</span>, <span class="string">'GarageCond'</span>, <span class="string">'GarageType'</span>, <span class="string">'GarageFinish'</span>, <span class="string">'GarageQual'</span>, <span class="string">'WoodDeckSF'</span>,</span><br><span class="line">            <span class="string">'OpenPorchSF'</span>, <span class="string">'EnclosedPorch'</span>, <span class="string">'3SsnPorch'</span>, <span class="string">'ScreenPorch'</span>, <span class="string">'PoolArea'</span>,</span><br><span class="line">            <span class="string">'MiscVal'</span>], axis=<span class="number">1</span>, inplace=<span class="keyword">True</span>)</span><br></pre></td></tr></table></figure></p>
<p>After this process, the following features are remains: <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">print(train.columns)</span><br><span class="line"></span><br><span class="line">Index([<span class="string">'MSSubClass'</span>, <span class="string">'MSZoning'</span>, <span class="string">'LotFrontage'</span>, <span class="string">'LotArea'</span>, <span class="string">'Street'</span>,</span><br><span class="line">       <span class="string">'LotShape'</span>, <span class="string">'LandContour'</span>, <span class="string">'LotConfig'</span>, <span class="string">'LandSlope'</span>, <span class="string">'Neighborhood'</span>,</span><br><span class="line">       <span class="string">'Condition1'</span>, <span class="string">'Condition2'</span>, <span class="string">'BldgType'</span>, <span class="string">'HouseStyle'</span>, <span class="string">'OverallQual'</span>,</span><br><span class="line">       <span class="string">'OverallCond'</span>, <span class="string">'YearBuilt'</span>, <span class="string">'YearRemodAdd'</span>, <span class="string">'RoofStyle'</span>, <span class="string">'Exterior1st'</span>,</span><br><span class="line">       <span class="string">'Exterior2nd'</span>, <span class="string">'ExterQual'</span>, <span class="string">'ExterCond'</span>, <span class="string">'Foundation'</span>, <span class="string">'HeatingQC'</span>,</span><br><span class="line">       <span class="string">'CentralAir'</span>, <span class="string">'Electrical'</span>, <span class="string">'GrLivArea'</span>, <span class="string">'FullBath'</span>, <span class="string">'HalfBath'</span>,</span><br><span class="line">       <span class="string">'BedroomAbvGr'</span>, <span class="string">'KitchenAbvGr'</span>, <span class="string">'KitchenQual'</span>, <span class="string">'TotRmsAbvGrd'</span>,</span><br><span class="line">       <span class="string">'Fireplaces'</span>, <span class="string">'GarageCars'</span>, <span class="string">'PavedDrive'</span>, <span class="string">'MoSold'</span>, <span class="string">'YrSold'</span>,</span><br><span class="line">       <span class="string">'SaleType'</span>, <span class="string">'SaleCondition'</span>, <span class="string">'SalePrice'</span>, <span class="string">'TotalSF'</span>],</span><br><span class="line">      dtype=<span class="string">'object'</span>)</span><br></pre></td></tr></table></figure></p>
<p>There is another important process is to fill the <code>NA</code> values within those features, normally, for categorical features, we can fill the <code>NA</code> with <strong>most frequent values</strong> or <strong>No(such feature)</strong>, while for the numeric features, we can fill <code>NA</code> with <strong>mean value</strong> or <strong>zero</strong>. And we do not talk too much about this here. Next step, we will analysis the relationship between each feature and <code>SalePrice</code>.</p>
<h3 id="univariate-analysis">Univariate Analysis</h3>
<p>Actually, there are four features which act as siginificantly important roles in this issue. Those four features are <code>OverallQual</code>, <code>YearBuilt</code>, <code>TotalBsmtSF</code> (after data integration process, it becomes <code>TotalSF</code>) and <code>GrLivArea</code>.</p>
<p><strong>OverallQual and SalePrice</strong> Here we explore the relationship between <code>OverallQual</code> and <code>SalePrice</code>: <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">overall_qual = pd.concat([train[<span class="string">'SalePrice'</span>], train[<span class="string">'OverallQual'</span>]], axis=<span class="number">1</span>)</span><br><span class="line">f, ax = sns.plt.subplots(figsize=(<span class="number">8</span>, <span class="number">6</span>))</span><br><span class="line">fig = sns.boxplot(x=<span class="string">'OverallQual'</span>, y=<span class="string">"SalePrice"</span>, data=overall_qual)</span><br><span class="line">fig.axis(ymin=<span class="number">0</span>, ymax=<span class="number">800000</span>)</span><br><span class="line">sns.plt.show()</span><br></pre></td></tr></table></figure></p>
<p>It is obvious that the distribution trends of <code>OverallQual</code> and <code>SalePrice</code> are same. Generally, the <code>SalePrice</code> increase while <code>OverallQual</code> increase. <img src="/images/machinelearning/houseprices/overallqual.png" alt="OverallQual-SalePrice"></p>
<p><strong>YearBuilt and SalePrice</strong> Here is the relationship between <code>YearBuilt</code> and <code>SalePrice</code>: <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">year_built = pd.concat([train[<span class="string">'SalePrice'</span>], train[<span class="string">'YearBuilt'</span>]], axis=<span class="number">1</span>)</span><br><span class="line">f, ax = sns.plt.subplots(figsize=(<span class="number">16</span>, <span class="number">8</span>))</span><br><span class="line">fig = sns.boxplot(x=<span class="string">'YearBuilt'</span>, y=<span class="string">"SalePrice"</span>, data=year_built)</span><br><span class="line">fig.axis(ymin=<span class="number">0</span>, ymax=<span class="number">800000</span>)</span><br><span class="line">sns.plt.xticks(rotation=<span class="number">90</span>)</span><br><span class="line">sns.plt.show()</span><br></pre></td></tr></table></figure></p>
<p>Although they do not show a strong following trends, this graph also indicates that, generally, the house price is higher while the built year is later. <img src="/images/machinelearning/houseprices/yearbuilt.png" alt="YearBuilt-SalePrice"></p>
<p><strong>TotalSF and SalePrice</strong> Here is the relationship between <code>TotalSF</code> and <code>SalePrice</code>: <img src="/images/machinelearning/houseprices/totalsf.png" alt="TotalSF"> As discussed before, this two features have strong correlation, and their trends are same. Since <code>TotalSF</code> is one of the most important feature, so let’s go deep. Here we show the distribution histogram and normal probalility graph of <code>TotalSF</code> to explore its normality: <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">sns.plt.figure()</span><br><span class="line">sns.plt.subplot(<span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>)</span><br><span class="line">sns.plt.title(<span class="string">"TotalSF Dist"</span>)</span><br><span class="line">sns.distplot(train[<span class="string">'TotalSF'</span>], fit=stats.norm)</span><br><span class="line">sns.plt.subplot(<span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>)</span><br><span class="line">stats.probplot(train[<span class="string">'TotalSF'</span>], plot=sns.plt)</span><br><span class="line">sns.plt.show()</span><br><span class="line">print(<span class="string">"Skewness: %f"</span> % train[<span class="string">'TotalSF'</span>].skew())</span><br><span class="line">print(<span class="string">"Kurtosis: %f"</span> % train[<span class="string">'TotalSF'</span>].kurt())</span><br><span class="line"><span class="comment"># Skewness and Kurtosis</span></span><br><span class="line">Skewness: <span class="number">1.776700</span></span><br><span class="line">Kurtosis: <span class="number">12.621968</span></span><br></pre></td></tr></table></figure></p>
<p>Compare with the distribution histogram and normal probalility graph of <code>SalePrice</code> we draw before, you will find that their situation are exactly similar， <code>TotalSF</code> shows positive biased, deviates from the normal distribution, has peak value. <img src="/images/machinelearning/houseprices/totalsf-dist.png" alt="TotalSF Distribution"> Same as <code>SalePrice</code>, we process <strong>logarithmic transformation</strong> on <code>TotalSF</code> and draw the graph again: <img src="/images/machinelearning/houseprices/totalsf-dist-log.png" alt="TotalSF Distribution Log"> The graph above shows that after log transformation, the normality of <code>TotalSF</code> becomes better. And below is the homoscedasticity of variance graph of <code>TotalSF</code> and <code>SalePrice</code>: <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sf = np.log(train[<span class="string">'TotalSF'</span>])</span><br><span class="line">sp = np.log(train[<span class="string">'SalePrice'</span>])</span><br><span class="line">sns.plt.scatter(sf[sf &gt; <span class="number">0</span>], sp[sf &gt; <span class="number">0</span>])</span><br><span class="line">sns.plt.show()</span><br></pre></td></tr></table></figure></p>
<p><img src="/images/machinelearning/houseprices/homoscedasticity-totalsf.png" alt="Homoscedasticity TotalSF"> This graph shows that <code>SalePrice</code> performs the same level of change within variable range of <code>TotalSF</code>. In this case, we may take the <strong>logarithmic transformation</strong> for <code>TotalSF</code> to fit <code>SalePrice</code> well.</p>
<p><strong>GrLivArea and SalePrice</strong> Here we do the same thing as <code>TotalSF</code> for <code>GrLivArea</code>. First, we draw the relationship between <code>GrLivArea</code> and <code>SalePrice</code>: <img src="/images/machinelearning/houseprices/grlivarea.png" alt="GrLivArea"> Then plot the distribution histogram and normal probalility graph of <code>GrLivArea</code> to show its normality. <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Skewness and Kurtosis</span></span><br><span class="line">Skewness: <span class="number">1.366560</span></span><br><span class="line">Kurtosis: <span class="number">4.895121</span></span><br></pre></td></tr></table></figure></p>
<p><img src="/images/machinelearning/houseprices/grlivarea-dist.png" alt="GrLivArea Distribution"> And do the <strong>logarithmic transformation</strong> on <code>GrLivArea</code> and show the graph again: <img src="/images/machinelearning/houseprices/grlivarea-dist-log.png" alt="GrLivArea Distribution Log"> Samely, the normality of <code>GrLivArea</code> becomes better after log transformation. Next, we explore the homoscedasticity of variance graph of <code>GrLivArea</code> and <code>SalePrice</code>: <img src="/images/machinelearning/houseprices/homoscedasticity-grlivarea.png" alt="Homoscedasticity GrLivArea"> This graph shows that <code>SalePrice</code> performs the same level of change within variable range of <code>GrLivArea</code>. In this case, we may take the <strong>logarithmic transformation</strong> for <code>GrLivArea</code> to fit <code>SalePrice</code> well.</p>
<p><strong>Others Univariables analysis</strong> Below shows the relationships between <code>SalePrice</code> and <code>LotFrontage</code>, <code>LotArea</code>, <code>LotShape</code>, <code>LandContour</code>, <code>LandShape</code> and <code>LotConfig</code>. From graph, we can derive that the <code>LogFrontage</code> shows slightly similar trends as <code>SalePrice</code>, it tends to increase while <code>SalePrice</code> increase. However, others do not have such feature, while each value in each feature does not give a clear trends. <img src="/images/machinelearning/houseprices/1.png" alt="1"> And the following six features also do not have a clear relationship on <code>SalePrice</code>: <img src="/images/machinelearning/houseprices/2.png" alt="2"> However, although <code>YearRemodAdd</code> feature does not give a clear trends, compare to <code>YearBuilt</code> feature, it still indicates that the house price is higher while the <code>RemodAdd</code> year is later. <img src="/images/machinelearning/houseprices/yearremodadd.png" alt="YearRemodAdd"> There are still many features do not show here, but each of them are worth to analyze. For analysis, we stop here and make a short summary. - For <code>Bsmt...</code> feature group, drop all of them, except <code>TotalBsmtSF</code>, then merge <code>TotalBsmtSF</code> with <code>1stFlrSF</code> and <code>2ndFlrSF</code> to create a new feature named as <code>TotalSF</code>. - For <code>Garage...</code> feature group, drop all of them, except <code>GarageCars</code>. - Drop the features whose missing percentage is large than 20%. - Drop the features that we treat them as the trivial features for the house prices predictation. - Fill <code>NA</code> with most frequent value or zero or mean.</p>
<p>and so forth.</p>
<h1 id="conclusion">Conclusion</h1>
<p>In the above, I describe a procedure to analysis the data and the machine learning model for training and predicting the data will be introduced in next article. Actually, with the data process procedures introduced above and the machine learning model (I choose a model with combination of gradient boosting regressor and elastic net), I achieve the score <strong>0.126</strong>. It is not a very good result, but, anyway, this is just a practice after learning the basic knowledge of data science and mechine learning. Below is the data clean, integration and transformation codes: <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> ensemble, linear_model</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split, cross_val_score</span><br><span class="line"><span class="keyword">from</span> sklearn.utils <span class="keyword">import</span> shuffle</span><br><span class="line"><span class="keyword">from</span> method2.functions <span class="keyword">import</span> train_test</span><br><span class="line"><span class="keyword">import</span> warnings</span><br><span class="line">warnings.filterwarnings(<span class="string">'ignore'</span>)</span><br><span class="line"><span class="comment"># load data</span></span><br><span class="line">train = pd.read_csv(<span class="string">'train.csv'</span>)</span><br><span class="line">test = pd.read_csv(<span class="string">'test.csv'</span>)</span><br><span class="line">train_labels = train.pop(<span class="string">'SalePrice'</span>)</span><br><span class="line">data = pd.concat([train, test], keys=[<span class="string">'train'</span>, <span class="string">'test'</span>])</span><br><span class="line"><span class="comment"># drop the data with high missing percentage</span></span><br><span class="line">data.drop([<span class="string">'Id'</span>, <span class="string">'MiscFeature'</span>, <span class="string">'Fence'</span>, <span class="string">'PoolQC'</span>, <span class="string">'FireplaceQu'</span>, <span class="string">'Alley'</span>], axis=<span class="number">1</span>, inplace=<span class="keyword">True</span>)</span><br><span class="line"><span class="comment"># drop the Bsmt feature group, Garage feature group as well as some trivial features</span></span><br><span class="line">data.drop([<span class="string">'Utilities'</span>, <span class="string">'RoofMatl'</span>, <span class="string">'MasVnrArea'</span>, <span class="string">'MasVnrType'</span>, <span class="string">'Heating'</span>, <span class="string">'LowQualFinSF'</span>, <span class="string">'BsmtFullBath'</span>,</span><br><span class="line">           <span class="string">'BsmtHalfBath'</span>, <span class="string">'BsmtQual'</span>, <span class="string">'BsmtCond'</span>, <span class="string">'BsmtExposure'</span>, <span class="string">'BsmtFinType1'</span>, <span class="string">'BsmtFinSF1'</span>, <span class="string">'BsmtFinSF2'</span>,</span><br><span class="line">           <span class="string">'BsmtUnfSF'</span>, <span class="string">'BsmtFinType2'</span>, <span class="string">'Functional'</span>, <span class="string">'WoodDeckSF'</span>, <span class="string">'OpenPorchSF'</span>,</span><br><span class="line">           <span class="string">'GarageYrBlt'</span>, <span class="string">'GarageCond'</span>, <span class="string">'GarageType'</span>, <span class="string">'GarageFinish'</span>, <span class="string">'GarageQual'</span>, <span class="string">'GarageArea'</span>,</span><br><span class="line">           <span class="string">'EnclosedPorch'</span>, <span class="string">'3SsnPorch'</span>, <span class="string">'ScreenPorch'</span>, <span class="string">'PoolArea'</span>, <span class="string">'MiscVal'</span>], axis=<span class="number">1</span>, inplace=<span class="keyword">True</span>)</span><br><span class="line"><span class="comment"># merge TotalBsmtSF, 1stFlrSF, 2ndFlrSF to TotalSF</span></span><br><span class="line">data[<span class="string">'TotalBsmtSF'</span>] = data[<span class="string">'TotalBsmtSF'</span>].fillna(<span class="number">0</span>)</span><br><span class="line">data[<span class="string">'1stFlrSF'</span>] = data[<span class="string">'1stFlrSF'</span>].fillna(<span class="number">0</span>)</span><br><span class="line">data[<span class="string">'2ndFlrSF'</span>] = data[<span class="string">'2ndFlrSF'</span>].fillna(<span class="number">0</span>)</span><br><span class="line">data[<span class="string">'TotalSF'</span>] = data[<span class="string">'TotalBsmtSF'</span>] + data[<span class="string">'1stFlrSF'</span>] + data[<span class="string">'2ndFlrSF'</span>]</span><br><span class="line">data.drop([<span class="string">'TotalBsmtSF'</span>, <span class="string">'1stFlrSF'</span>, <span class="string">'2ndFlrSF'</span>], axis=<span class="number">1</span>, inplace=<span class="keyword">True</span>)</span><br><span class="line"><span class="comment"># MSSubClass as categorical</span></span><br><span class="line">data[<span class="string">'MSSubClass'</span>] = data[<span class="string">'MSSubClass'</span>].astype(str)</span><br><span class="line"><span class="comment"># MSZoning: filling NA with most popular values</span></span><br><span class="line">data[<span class="string">'MSZoning'</span>] = data[<span class="string">'MSZoning'</span>].fillna(data[<span class="string">'MSZoning'</span>].mode()[<span class="number">0</span>])</span><br><span class="line"><span class="comment"># LotFrontage: fill NA with mean value</span></span><br><span class="line">data[<span class="string">'LotFrontage'</span>] = data[<span class="string">'LotFrontage'</span>].fillna(data[<span class="string">'LotFrontage'</span>].mean())</span><br><span class="line"><span class="comment"># OverallCond as categorical</span></span><br><span class="line">data[<span class="string">'OverallCond'</span>] = data[<span class="string">'OverallCond'</span>].astype(str)</span><br><span class="line"><span class="comment"># Electrical: fill NA with most popular values</span></span><br><span class="line">data[<span class="string">'Electrical'</span>] = data[<span class="string">'Electrical'</span>].fillna(data[<span class="string">'Electrical'</span>].mode()[<span class="number">0</span>])</span><br><span class="line"><span class="comment"># KitchenAbvGr as categorical</span></span><br><span class="line">data[<span class="string">'KitchenAbvGr'</span>] = data[<span class="string">'KitchenAbvGr'</span>].astype(str)</span><br><span class="line"><span class="comment"># KitchenQual: fill NA with most popular values</span></span><br><span class="line">data[<span class="string">'KitchenQual'</span>] = data[<span class="string">'KitchenQual'</span>].fillna(data[<span class="string">'KitchenQual'</span>].mode()[<span class="number">0</span>])</span><br><span class="line"><span class="comment"># GarageCars: fill NA with 0</span></span><br><span class="line">data[<span class="string">'GarageCars'</span>] = data[<span class="string">'GarageCars'</span>].fillna(<span class="number">0.0</span>)</span><br><span class="line"><span class="comment"># SaleType: fill NA with most popular values</span></span><br><span class="line">data[<span class="string">'SaleType'</span>] = data[<span class="string">'SaleType'</span>].fillna(data[<span class="string">'SaleType'</span>].mode()[<span class="number">0</span>])</span><br><span class="line"><span class="comment"># Year and Month as categorical</span></span><br><span class="line">data[<span class="string">'YrSold'</span>] = data[<span class="string">'YrSold'</span>].astype(str)</span><br><span class="line">data[<span class="string">'MoSold'</span>] = data[<span class="string">'MoSold'</span>].astype(str)</span><br><span class="line"><span class="comment"># Exterior1st and Exterior2nd: fill NA with most popular values</span></span><br><span class="line">data[<span class="string">'Exterior1st'</span>] = data[<span class="string">'Exterior1st'</span>].fillna(data[<span class="string">'Exterior2nd'</span>].mode()[<span class="number">0</span>])</span><br><span class="line">data[<span class="string">'Exterior2nd'</span>] = data[<span class="string">'Exterior2nd'</span>].fillna(data[<span class="string">'Exterior2nd'</span>].mode()[<span class="number">0</span>])</span><br><span class="line"><span class="comment"># Standardizing LotFrontage and LotArea</span></span><br><span class="line">numeric_data = data.loc[:, [<span class="string">'LotFrontage'</span>, <span class="string">'LotArea'</span>, <span class="string">'GrLivArea'</span>, <span class="string">'TotalSF'</span>]]</span><br><span class="line">numeric_data_standardized = (numeric_data - numeric_data.mean())/numeric_data.std()</span><br><span class="line"><span class="comment"># Log transformation of labels, GrLivArea and TotalSF</span></span><br><span class="line">train_labels = np.log(train_labels)</span><br><span class="line"><span class="comment"># data['GrLivArea'] = np.log(data['GrLivArea'])</span></span><br><span class="line"><span class="comment"># data['TotalSF'] = np.log(data['TotalSF'])</span></span><br><span class="line"><span class="comment"># Getting Dummies from Condition1 and Condition2</span></span><br><span class="line">conditions = set([x <span class="keyword">for</span> x <span class="keyword">in</span> data[<span class="string">'Condition1'</span>]] + [x <span class="keyword">for</span> x <span class="keyword">in</span> data[<span class="string">'Condition2'</span>]])</span><br><span class="line">dummies = pd.DataFrame(data=np.zeros((len(data.index), len(conditions))), index=data.index, columns=conditions)</span><br><span class="line"><span class="keyword">for</span> i, cond <span class="keyword">in</span> enumerate(zip(data[<span class="string">'Condition1'</span>], data[<span class="string">'Condition2'</span>])):</span><br><span class="line">    dummies.ix[i, cond] = <span class="number">1</span></span><br><span class="line">data = pd.concat([data, dummies.add_prefix(<span class="string">'Condition_'</span>)], axis=<span class="number">1</span>)</span><br><span class="line">data.drop([<span class="string">'Condition1'</span>, <span class="string">'Condition2'</span>], axis=<span class="number">1</span>, inplace=<span class="keyword">True</span>)</span><br><span class="line"><span class="comment"># Getting Dummies from Exterior1st and Exterior2nd</span></span><br><span class="line">exteriors = set([x <span class="keyword">for</span> x <span class="keyword">in</span> data[<span class="string">'Exterior1st'</span>]] + [x <span class="keyword">for</span> x <span class="keyword">in</span> data[<span class="string">'Exterior2nd'</span>]])</span><br><span class="line">dummies = pd.DataFrame(data=np.zeros((len(data.index), len(exteriors))), index=data.index, columns=exteriors)</span><br><span class="line"><span class="keyword">for</span> i, ext <span class="keyword">in</span> enumerate(zip(data[<span class="string">'Exterior1st'</span>], data[<span class="string">'Exterior2nd'</span>])):</span><br><span class="line">    dummies.ix[i, ext] = <span class="number">1</span></span><br><span class="line">data = pd.concat([data, dummies.add_prefix(<span class="string">'Exterior_'</span>)], axis=<span class="number">1</span>)</span><br><span class="line">data.drop([<span class="string">'Exterior1st'</span>, <span class="string">'Exterior2nd'</span>], axis=<span class="number">1</span>, inplace=<span class="keyword">True</span>)</span><br><span class="line"><span class="comment"># Getting Dummies from all other categorical vars</span></span><br><span class="line"><span class="keyword">for</span> col <span class="keyword">in</span> data.dtypes[data.dtypes == <span class="string">'object'</span>].index:</span><br><span class="line">    for_dummy = data.pop(col)</span><br><span class="line">    data = pd.concat([data, pd.get_dummies(for_dummy, prefix=col)], axis=<span class="number">1</span>)</span><br><span class="line"><span class="comment"># copy data</span></span><br><span class="line">data_standardized = data.copy()</span><br><span class="line"><span class="comment"># Replacing numeric feature by standardized values</span></span><br><span class="line">data_standardized.update(numeric_data_standardized)</span><br><span class="line"><span class="comment"># Splitting dataset to train and test</span></span><br><span class="line">train_data = data.loc[<span class="string">'train'</span>].select_dtypes(include=[np.number]).values</span><br><span class="line">test_data = data.loc[<span class="string">'test'</span>].select_dtypes(include=[np.number]).values</span><br><span class="line"><span class="comment"># Splitting standardized features</span></span><br><span class="line">train_data_st = data_standardized.loc[<span class="string">'train'</span>].select_dtypes(include=[np.number]).values</span><br><span class="line">test_data_st = data_standardized.loc[<span class="string">'test'</span>].select_dtypes(include=[np.number]).values</span><br></pre></td></tr></table></figure></p>
<p>I also explored others methods and make a midification to improve the result to <strong>0.116</strong>. I will describe it in the future.</p>
<h1 id="reference">Reference</h1>
<ul>
<li><a href="https://www.kaggle.com/c/house-prices-advanced-regression-techniques/kernels" target="_blank" rel="noopener">Kaggle Kernels of House Prices</a></li>
<li><a href="https://www.leiphone.com/news/201704/Py7Mu3TwRF97pWc7.html" target="_blank" rel="noopener">Comprehensive Data Exploration using Python</a></li>
<li><a href="https://www.kaggle.com/neviadomski/how-to-get-to-top-25-with-simple-model-sklearn" target="_blank" rel="noopener">How to get to TOP 25% with Simple Model (sklearn)</a></li>
<li><a href="https://www.kaggle.com/miguelangelnieto/pca-and-regression" target="_blank" rel="noopener">PCA and Regression</a></li>
</ul>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        
  <ul class="post-copyright">
    <li class="post-copyright-author">
      <strong>Author:</strong>
      Isaac Changhau
    </li>
    <li class="post-copyright-link">
      <strong>Link:</strong>
      <a href="https://isaacchanghau.github.io/2017/07/08/House-Price-Advanced-Regression-Techniques-1/" title="House Prices Advanced Regression Techniques -- Data Analysis Exploration">https://isaacchanghau.github.io/2017/07/08/House-Price-Advanced-Regression-Techniques-1/</a>
    </li>
    <li class="post-copyright-license">
      <strong>Notice: </strong>
      All articles are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/" rel="external nofollow" target="_blank">CC BY-NC-SA 3.0</a> unless stating additionally. Contact me via email for questions or discussion.
    </li>
  </ul>


      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/machine-learning/" rel="tag"># machine learning</a>
          
            <a href="/tags/python/" rel="tag"># python</a>
          
            <a href="/tags/data-analysis/" rel="tag"># data analysis</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/06/28/Spark-Installation-on-Mac-OS-X/" rel="next" title="Spark Installation on Mac OS X">
                <i class="fa fa-chevron-left"></i> Spark Installation on Mac OS X
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2017/07/10/House-Price-Advanced-Regression-Techniques-2/" rel="prev" title="House Prices Advanced Regression Techniques -- Training and Prediction">
                House Prices Advanced Regression Techniques -- Training and Prediction <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            Overview
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.gif"
               alt="Isaac Changhau" />
          <p class="site-author-name" itemprop="name">Isaac Changhau</p>
           
              <p class="site-description motion-element" itemprop="description">Stay Hungry, Stay Foolish</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives/">
                <span class="site-state-item-count">44</span>
                <span class="site-state-item-name">posts</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">8</span>
                <span class="site-state-item-name">categories</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">41</span>
                <span class="site-state-item-name">tags</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="mailto:isaac.changhau@gmail.com" target="_blank" title="Email">
                  
                    <i class="fa fa-fw fa-envelope"></i>
                  
                  Email
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://www.linkedin.com/in/isaac-changhau" target="_blank" title="Linkedin">
                  
                    <i class="fa fa-fw fa-linkedin"></i>
                  
                  Linkedin
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://github.com/IsaacChanghau" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#competition-description"><span class="nav-number">1.</span> <span class="nav-text">Competition Description</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#data-analysis-and-feature-extraction"><span class="nav-number">2.</span> <span class="nav-text">Data Analysis and Feature Extraction</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#preliminary-analysis"><span class="nav-number">2.1.</span> <span class="nav-text">Preliminary Analysis</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#data-preview"><span class="nav-number">2.1.1.</span> <span class="nav-text">Data Preview</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#labels-saleprice"><span class="nav-number">2.1.2.</span> <span class="nav-text">Labels (“SalePrice”)</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#systematic-analysis"><span class="nav-number">2.2.</span> <span class="nav-text">Systematic Analysis</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#data-clean-integration-and-correlation-analysis"><span class="nav-number">2.2.1.</span> <span class="nav-text">Data Clean, Integration and Correlation Analysis</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#univariate-analysis"><span class="nav-number">2.2.2.</span> <span class="nav-text">Univariate Analysis</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#conclusion"><span class="nav-number">3.</span> <span class="nav-text">Conclusion</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#reference"><span class="nav-number">4.</span> <span class="nav-text">Reference</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      
        <div class="back-to-top">
          <i class="fa fa-arrow-up"></i>
          
            <span id="scrollpercent"><span>0</span>%</span>
          
        </div>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2017 - 
  <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-star"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Isaac Changhau</span>
</div>


<div class="powered-by">
  Powered by <a class="theme-link" href="https://hexo.io">Hexo</a>
</div>

<div class="theme-info">
  Theme -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT
  </a>
</div>


        

        
      </div>
    </footer>

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.1"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.1"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.1"></script>



  


  




	





  





  





  






  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config("");
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->





  

  

  

  
  


  

  

</body>
</html>
